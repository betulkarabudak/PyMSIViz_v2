from PyQt5.QtCore import QThread, pyqtSignalimport timeclass ProgressBarThread(QThread):    bar_signal = pyqtSignal(int)    def __init__(self):        super().__init__()        self._is_running = True    def run(self):        for i in range(100):            if not self._is_running:                break            time.sleep(0.02)            self.bar_signal.emit(i + 1)    def stop(self):        self._is_running = Falseclass WorkerManager:    def __init__(self):        self.current = None    def start(self, worker):        if self.current is not None:            try:                self.current.cancel()            except Exception:                pass        self.current = worker        worker.start()class LoadImzMLThread(QThread):    result = pyqtSignal(object)    error = pyqtSignal(str)    def __init__(self, filename):        super().__init__()        self.filename = filename    def run(self):        try:            from core.msi_tasks import task_load_imzml_safe            payload = task_load_imzml_safe(self.filename)            self.result.emit(payload)        except Exception as e:            self.error.emit(str(e))